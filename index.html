<!DOCTYPE html>
<html lang="es-co">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/static/img/favicon.ico">
    <title>Abonos - AYAPEL</title>

    <meta name="description" content="">
    <meta name="author" content="Creditos Echeverry">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <link rel="stylesheet" href="/static/CACHE/css/0c15876fb430.css" type="text/css" />
    
    
    
    
</head>
<body id="abonos" role="document" >
    <div class="container">
        <!-- Encabezado -->
        <header>
            <nav class="navbar navbar-default" role="navigation">
                <div class="container-fluid">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="#">Recaudos 1.0</a>
                    </div>

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse">
                        <ul class="nav navbar-nav navbar-right">
                            
    <li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"> AYAPEL <span class="caret"></span></a>
    <ul class="dropdown-menu" role="menu">
    
        <li><a href="/deudas/AYAPEL/?page=1">AYAPEL</a></li>
    
        <li><a href="/deudas/BAGRE_1/?page=1">BAGRE 1</a></li>
    
        <li><a href="/deudas/CARACOLI/?page=1">CARACOLI</a></li>
    
        <li><a href="/deudas/CAUCA_1/?page=1">CAUCA 1</a></li>
    
        <li><a href="/deudas/CAUCASIA/?page=1">CAUCASIA</a></li>
    
        <li><a href="/deudas/EL_27/?page=1">EL 27</a></li>
    
        <li><a href="/deudas/EL__50/?page=1">EL  50</a></li>
    
        <li><a href="/deudas/ESPERANZA/?page=1">ESPERANZA</a></li>
    
        <li><a href="/deudas/JARDIN/?page=1">JARDIN</a></li>
    
        <li><a href="/deudas/LA__APARTADA/?page=1">LA  APARTADA</a></li>
    
        <li><a href="/deudas/LA_CRUZADA/?page=1">LA CRUZADA</a></li>
    
        <li><a href="/deudas/LA_FLORESTA/?page=1">LA FLORESTA</a></li>
    
        <li><a href="/deudas/LAS_BRISAS/?page=1">LAS BRISAS</a></li>
    
        <li><a href="/deudas/LAS_MALVINAS/?page=1">LAS MALVINAS</a></li>
    
        <li><a href="/deudas/LA_VEGA/?page=1">LA VEGA</a></li>
    
        <li><a href="/deudas/MONACO/?page=1">MONACO</a></li>
    
        <li><a href="/deudas/MONTELIBANO/?page=1">MONTELIBANO</a></li>
    
        <li><a href="/deudas/PALIZADA/?page=1">PALIZADA</a></li>
    
        <li><a href="/deudas/PLANETA/?page=1">PLANETA</a></li>
    
        <li><a href="/deudas/PORTUGAL/?page=1">PORTUGAL</a></li>
    
        <li><a href="/deudas/PTO_LIBERTADOR/?page=1">PTO LIBERTADOR</a></li>
    
        <li><a href="/deudas/PUEBLO_NUEVO/?page=1">PUEBLO NUEVO</a></li>
    
        <li><a href="/deudas/REMEDIOS/?page=1">REMEDIOS</a></li>
    
        <li><a href="/deudas/SAN_BARTOLO/?page=1">SAN BARTOLO</a></li>
    
        <li><a href="/deudas/SAN_CLEMENTE/?page=1">SAN CLEMENTE</a></li>
    
        <li><a href="/deudas/SAN_JOSE/?page=1">SAN JOSE</a></li>
    
        <li><a href="/deudas/SAN_PEDRO/?page=1">SAN PEDRO</a></li>
    
        <li><a href="/deudas/TIERRA_ALTA/?page=1">TIERRA ALTA</a></li>
    
        <li><a href="/deudas/TIERRA_ALTA_2/?page=1">TIERRA ALTA 2</a></li>
    
        <li><a href="/deudas/VALENCIA/?page=1">VALENCIA</a></li>
    
        <li><a href="/deudas/VILLA_CLEMEN/?page=1">VILLA CLEMEN</a></li>
    
        <li><a href="/deudas/ZARAGOZA/?page=1">ZARAGOZA</a></li>
    
        <li><a href="/deudas/ZARAGOZA_2/?page=1">ZARAGOZA 2</a></li>
    
    </ul>
</li>


                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"> Menu <span class="caret"></span></a>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a href="/admin/recaudo/cliente/">Clientes</a>
                                    </li>
                                    <li><a href="/admin/recaudo/codeudor/">Codeudores</a>
                                    </li>
                                    <li class="divider"></li>
                                    
                                    <li><a href="/admin/recaudo/cobro/">Cobros</a></li>
                                    <li><a href="/admin/recaudo/retiro/">Retiros</a></li>
                                    <li class="divider"></li>
                                    
                                    <li><a href="/admin/recaudo/gasto/">Gastos</a></li>
                                    <li><a href="/admin/recaudo/deuda/">Deudas</a></li>
                                    <li><a href="/admin/recaudo/abono/">Abonos</a></li>
                                    <li class="divider"></li>
                                    
                                    <li><a href="/cliente/loteria/">Jugar Loteria</a></li>
                                    
                                </ul>
                            </li>

                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Reportes <span class="caret"></span></a>
                                <ul class="dropdown-menu" role="menu">
                                    
                                    <li><a href="/reporte/sumasaldos/">Suma Saldos</a>
                                    </li>
                                    <li><a href="/reporte/contabilidad/">Contabilidad</a>
                                    <li class="divider"></li>
                                    <li><a href="/reporte/contabilidad_empresas/">Contabilidad Empresas</a>
                                    </li>
                                    </li>
                                    
                                    <li><a href="/reporte/reportetarjetas/">Canceladas</a>
                                    </li>
                                </ul>
                            </li>

                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Dubereg1809 <span class="caret"></span></a>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a href="/admin/logout/">Salir</a>
                                    </li>
                                </ul>
                            </li>

                        </ul>
                    </div>
                    <!-- /.navbar-collapse -->
                </div>
                <!-- /.container-fluid -->
            </nav>
        </header>
        
<header>
    <nav class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <div class="collapse navbar-collapse">

                <ul class="nav navbar-nav">
                    <li>
                        <form class="navbar-form navbar-left">
                            <div class="btn-group">
                                <button id="menu_posicion" type="submit" class="btn btn-info">
                                + Cliente despues</button>
                                <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                    <span class="caret"></span>
                                    <span class="sr-only">Toggle Dropdown</span>
                                </button>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a id="id_antes">Antes</a><li>
                                    <li class="divider"></li>
                                    <li><a id="id_despues">Despues</a></li>
                                </ul>
                            </div>
                        </form>
                    </li>
                    <li>
                        <div class="btn-group" role="group">
                            
<a href="?page=1" type="button" class="btn btn-info navbar-btn" >
    <i class="icon-fastleft"></i> 
</a>

                            
<a href="?page=1" type="button" class="btn btn-info navbar-btn" >
    <i class="icon-arrow-left"></i> 
</a>

                            
<a href="?page=2" type="button" class="btn btn-info navbar-btn" >
    <i class="icon-arrow-right"></i> 
</a>

                            
<a href="?page=230" type="button" class="btn btn-info navbar-btn" >
    <i class="icon-fastright"></i> 
</a>

                        </div>
                    </li>
                    <li>
                       <div id="formTarjetaBar" class="navbar-text">Tarjeta ID=244472/12358 <b># 1 / 230 </b> # Abonos=4 <span class="badge cliente_Clavo" data-bind="text: calificacion"></span>
                       
                       
                       </div>
                    </li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/admin/recaudo/gasto/73859/change/" role="button" class="btn btn-default navbar-btn">+ $ Cobrador</a>
                    </li>
                    <li class="divider-vertical"></li>
                    <li>
                        <div class="btn-group">
                            <button type="button" class="btn btn-default dropdown-toggle navbar-btn" data-toggle="dropdown" aria-expanded="false">
                                Opciones <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                
                                <li><a href="/cliente/historial/12358/">Historial</a>
                                </li>
                                <li class="divider"></li>
                                
                                
                                <li><a data-toggle="modal" data-target="#modal-retirar">Retirar Tarjeta</a>
                                </li>
                                
                                <li><a href="/cliente/archivos/43894466-1/">Archivos</a>
                                </li>

                                
                            </ul>
                        </div>
                    </li>

                    <li class="divider-vertical"></li>
                    <li>
                        <div class="btn-group">
                            
<a href="/deudas/AYAPEL/?nuevo=True" type="button" class="btn btn-primary navbar-btn" >
    <i class="icon-plus-sign"></i> Deuda
</a>

                        </div>
                    </li>

                    <li class="divider-vertical"></li>

                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
</header>

<content class="row">
    <section class="col-xs-12">
        <form id="formDeuda" action="/deudas/AYAPEL/?" method="post" role="form">
        <div class="row">
            <input type='hidden' name='csrfmiddlewaretoken' value='3dfRaOqakPo6lh81HrEtF2Uci6QazwJw0paEADDMwLHwoKdrhobJEi9q4m7EMKd1' />

            
<div class="form-group col-xs-12">
    <div class="input-group">
        <span class="input-group-addon">Cobro</span>

        
        <input type="hidden" class="form-control" id="id_deuda_id"
            name="deuda_id"
            data-bind="value: deuda_id, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Cobro" />
        

        <span data-bind='visible: deuda_id.hasError, text: deuda_id.errors'></span>
    </div>
</div>

            
<div class="form-group col-xs-4">
    <div class="input-group">
        <span class="input-group-addon">Código</span>

        
        <input type="text" class="form-control" id="id_codigo"
            name="codigo"
            data-bind="value: codigo, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Código" required="required" maxlength="150" />
        

        <span data-bind='visible: codigo.hasError, text: codigo.errors'></span>
    </div>
</div>


            
<div class="form-group col-xs-8">
    <div class="input-group">
        <span class="input-group-addon">Nombre</span>

        
        <input type="text" class="form-control" id="id_nombre"
            name="nombre"
            data-bind="value: nombre, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Nombre" required="required" maxlength="150" />
        

        <span data-bind='visible: nombre.hasError, text: nombre.errors'></span>
    </div>
</div>


            
<div class="form-group col-xs-4">
    <div class="input-group">
        <span class="input-group-addon">Dir</span>

        
        <input type="text" class="form-control" id="id_direccion"
            name="direccion"
            data-bind="value: direccion, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Dir" required="required" maxlength="250" />
        

        <span data-bind='visible: direccion.hasError, text: direccion.errors'></span>
    </div>
</div>

            
<div class="form-group col-xs-3">
    <div class="input-group">
        <span class="input-group-addon">Tel / Cel</span>

        
        <input type="text" class="form-control" id="id_telefono"
            name="telefono"
            data-bind="value: telefono, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Tel / Cel" required="required" />
        

        <span data-bind='visible: telefono.hasError, text: telefono.errors'></span>
    </div>
</div>

            
                
<div class="form-group col-xs-3">
    <div class="input-group">
        <span class="input-group-addon">Fecha</span>

        
        <input type="text" class="form-control" id="id_fecha"
            name="fecha"
            data-bind="value: fecha, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Fecha" required="required" />
        <div class="input-group-addon">D/M/Y</div>

        <span data-bind='visible: fecha.hasError, text: fecha.errors'></span>
    </div>
</div>


                
<div class="form-group col-xs-2">
    <div class="input-group">
        <span class="input-group-addon">Plazo</span>

        
        <input type="text" class="form-control" id="id_plazo"
            name="plazo"
            data-bind="value: plazo, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Plazo" />
        <div class="input-group-addon">días</div>

        <span data-bind='visible: plazo.hasError, text: plazo.errors'></span>
    </div>
</div>


                
<div class="form-group col-xs-3">
    <div class="input-group">
        <span class="input-group-addon">Valor $</span>

        
        <input type="text" class="form-control" id="id_valor"
            name="valor"
            data-bind="value: valor, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Valor $" required="required" />
        <div class="input-group-addon">.0000</div>

        <span data-bind='visible: valor.hasError, text: valor.errors'></span>
    </div>
</div>

            
            
<div class="form-group col-xs-3">
    <div class="input-group">
        <span class="input-group-addon">Pagar $</span>

        
        <input type="text" class="form-control" id="id_valorPagar"
            name="valorPagar"
            data-bind="value: valorPagar, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Pagar $" readonly />
        

        <span data-bind='visible: valorPagar.hasError, text: valorPagar.errors'></span>
    </div>
</div>

            
<div class="form-group col-xs-2">
    <div class="input-group">
        <span class="input-group-addon">Cuota $</span>

        
        <input type="text" class="form-control" id="id_cuota"
            name="cuota"
            data-bind="value: cuota, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Cuota $" readonly />
        

        <span data-bind='visible: cuota.hasError, text: cuota.errors'></span>
    </div>
</div>

            
                
<div class="form-group col-xs-2">
    <div class="input-group">
        <span class="input-group-addon">Lotería</span>

        
        <input type="text" class="form-control" id="id_loteria"
            name="loteria"
            data-bind="value: loteria, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Lotería" readonly />
        

        <span data-bind='visible: loteria.hasError, text: loteria.errors'></span>
    </div>
</div>

                
<div class="form-group col-xs-2">
    <div class="input-group">
        <span class="input-group-addon">$</span>

        
        <input type="text" class="form-control" id="id_valorLoteria"
            name="valorLoteria"
            data-bind="value: valorLoteria, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese $" readonly />
        

        <span data-bind='visible: valorLoteria.hasError, text: valorLoteria.errors'></span>
    </div>
</div>

            

            
            <div class="col-xs-12">
                <div class="form-group">
                
                    
<button id="default" type="submit" class="btn btn-primary navbar-btn" name="default" data-bind='enable: canSave'>
    <i class="icon-save-floppy"></i> Guardar
</button>

                    
                
                </div>
                <section data-bind="ifnot: isValid()">
                    <div class="alert alert-warning" role="alert">
                        <h4>Errores:</h4>

                        <ul data-bind="foreach: { data: errors, as: 'error'}">
                            <li data-bind="text: error"></li>
                        </ul>
                    </div>
                </section>
            </div>
        </div>
        </form>
    </section>
    
</content>


<content class="row">
    <div class="col-md-8">
        <section id="seccionTarjeta">
            <div class="panel panel-default">
                <div class="panel-body">
                    <form id="formAbono" data-bind="submit: doAbonar" role="form">
                        <div class="row">
                            
<div class="form-group col-xs-12">
    <div class="input-group">
        <span class="input-group-addon">Valor Abono</span>

        
        <input type="text" class="form-control" id="id_valorAbono"
            name="valorAbono"
            data-bind="value: valorAbono, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Valor Abono" />
        <div class="input-group-addon">.0000</div>

        <span data-bind='visible: valorAbono.hasError, text: valorAbono.errors'></span>
    </div>
</div>

                            
<div class="form-group col-xs-6">
    <div class="input-group">
        <span class="input-group-addon">Falta pagar</span>

        
        <input type="text" class="form-control" id="id_falta"
            name="falta"
            data-bind="value: falta, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Falta pagar" readonly />
        

        <span data-bind='visible: falta.hasError, text: falta.errors'></span>
    </div>
</div>

                            
<div class="form-group col-xs-6">
    <div class="input-group">
        <span class="input-group-addon">Pagado</span>

        
        <input type="text" class="form-control" id="id_saldo"
            name="saldo"
            data-bind="value: saldo, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Pagado" readonly />
        

        <span data-bind='visible: saldo.hasError, text: saldo.errors'></span>
    </div>
</div>

                            <div class="col-xs-12">
                            
                                
<button id="default" type="submit" class="btn btn-primary navbar-btn" name="default" data-bind='enable: canSave'>
    <i class="icon-circleadd"></i> Abonar
</button>

                            

                                <div class="btn-group">
                                  <button type="button" class="btn" data-toggle="modal" data-target="#modal-comment">+ Comentario <span class="badge" data-bind="text: comentarios().length"></span></button>
                                  <button type="button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <span class="caret"></span>
                                    <span class="sr-only">Ver comentarios</span>
                                  </button>
                                  <ul data-bind="foreach: comentarios()" class="dropdown-menu">
                                    <li><a href="#" data-bind="text: comentario"></a></li>
                                  </ul>
                                </div>
                                
                                <button type="button" class="btn btn-danger navbar-btn" data-bind="click: eliminarCuota">Eliminar Ultima Cuota</button>
                                
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        
<div class="scrollable">
<table id="tablaAbonos" class="table table-striped">
  <thead>
    <tr>
      <th>Fecha Servidor</th>
      <th>Fecha Móvil</th>
      <th class="text-right">Abono</th>
      <th class="text-right">Saldo</th>
    </tr>
  </thead>
  <tbody>
    
    <tr>
      <td>22/10/22 17:10</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 30.000.00</th>
    </tr>
    
    <tr>
      <td>20/10/22 18:10</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 35.000.00</th>
    </tr>
    
    <tr>
      <td>17/10/22 18:10</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 40.000.00</th>
    </tr>
    
    <tr>
      <td>12/10/22 17:10</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 45.000.00</th>
    </tr>
    
    <tr>
      <td>10/10/22 19:10</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 50.000.00</th>
    </tr>
    
    <tr>
      <td>07/10/22 18:10</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 55.000.00</th>
    </tr>
    
    <tr>
      <td>05/10/22 18:10</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 60.000.00</th>
    </tr>
    
    <tr>
      <td>04/10/22 18:10</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 65.000.00</th>
    </tr>
    
    <tr>
      <td>03/10/22 20:10</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 70.000.00</th>
    </tr>
    
    <tr>
      <td>27/09/22 18:09</th>
      <td>27/09/22 18:09</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 75.000.00</th>
    </tr>
    
    <tr>
      <td>22/09/22 18:09</th>
      <td>22/09/22 18:09</th>
      <td class="text-right">$ 10.000.00</th>
      <td class="text-right">$ 80.000.00</th>
    </tr>
    
    <tr>
      <td>20/09/22 19:09</th>
      <td>20/09/22 19:09</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 90.000.00</th>
    </tr>
    
    <tr>
      <td>16/09/22 08:09</th>
      <td>16/09/22 08:09</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 95.000.00</th>
    </tr>
    
    <tr>
      <td>14/09/22 20:09</th>
      <td>14/09/22 20:09</th>
      <td class="text-right">$ 20.000.00</th>
      <td class="text-right">$ 100.000.00</th>
    </tr>
    
    <tr>
      <td>09/09/22 18:09</th>
      <td>09/09/22 18:09</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 120.000.00</th>
    </tr>
    
    <tr>
      <td>02/09/22 19:09</th>
      <td>02/09/22 19:09</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 125.000.00</th>
    </tr>
    
    <tr>
      <td>31/08/22 18:08</th>
      <td>31/08/22 18:08</th>
      <td class="text-right">$ 10.000.00</th>
      <td class="text-right">$ 130.000.00</th>
    </tr>
    
    <tr>
      <td>26/08/22 08:08</th>
      <td>26/08/22 08:08</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 140.000.00</th>
    </tr>
    
    <tr>
      <td>22/08/22 20:08</th>
      <td>22/08/22 20:08</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 145.000.00</th>
    </tr>
    
    <tr>
      <td>19/08/22 17:08</th>
      <td>19/08/22 17:08</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 150.000.00</th>
    </tr>
    
    <tr>
      <td>16/08/22 19:08</th>
      <td>16/08/22 19:08</th>
      <td class="text-right">$ 10.000.00</th>
      <td class="text-right">$ 155.000.00</th>
    </tr>
    
    <tr>
      <td>13/08/22 18:08</th>
      <td>13/08/22 18:08</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 165.000.00</th>
    </tr>
    
    <tr>
      <td>09/08/22 19:08</th>
      <td>09/08/22 19:08</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 170.000.00</th>
    </tr>
    
    <tr>
      <td>06/08/22 09:08</th>
      <td>06/08/22 09:08</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 175.000.00</th>
    </tr>
    
    <tr>
      <td>03/08/22 17:08</th>
      <td>03/08/22 17:08</th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 180.000.00</th>
    </tr>
    
    <tr>
      <td>01/08/22 17:08</th>
      <td></th>
      <td class="text-right">$ 10.000.00</th>
      <td class="text-right">$ 185.000.00</th>
    </tr>
    
    <tr>
      <td>30/07/22 16:07</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 195.000.00</th>
    </tr>
    
    <tr>
      <td>29/07/22 16:07</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 200.000.00</th>
    </tr>
    
    <tr>
      <td>27/07/22 09:07</th>
      <td>27/07/22 09:07</th>
      <td class="text-right">$ 10.000.00</th>
      <td class="text-right">$ 205.000.00</th>
    </tr>
    
    <tr>
      <td>25/07/22 18:07</th>
      <td></th>
      <td class="text-right">$ 10.000.00</th>
      <td class="text-right">$ 215.000.00</th>
    </tr>
    
    <tr>
      <td>22/07/22 08:07</th>
      <td>22/07/22 08:07</th>
      <td class="text-right">$ 10.000.00</th>
      <td class="text-right">$ 225.000.00</th>
    </tr>
    
    <tr>
      <td>21/07/22 19:07</th>
      <td></th>
      <td class="text-right">$ 5.000.00</th>
      <td class="text-right">$ 235.000.00</th>
    </tr>
    
  </tbody>
</table>
</div>

        <section>
        
            <h4>Pagar el </h4>
        
        </section>

        <section>
            <form id="formVencidos" class="form-inline" role="form">
                <div class="row">
                    
<div class="form-group col-xs-6">
    <div class="input-group">
        <span class="input-group-addon">Vencidos</span>

        
        <input type="text" class="form-control" id="id_vencidos"
            name="vencidos"
            data-bind="value: vencidos, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Vencidos" readonly />
        

        <span data-bind='visible: vencidos.hasError, text: vencidos.errors'></span>
    </div>
</div>

                    
<div class="form-group col-xs-6">
    <div class="input-group">
        <span class="input-group-addon">Dias</span>

        
        <input type="text" class="form-control" id="id_dias"
            name="dias"
            data-bind="value: dias, valueUpdate: 'afterkeydown'"
            placeholder="Ingrese Dias" readonly />
        

        <span data-bind='visible: dias.hasError, text: dias.errors'></span>
    </div>
</div>

                </div>
            </form>
        </section>
    </div>

    <div class="col-md-4">
        
<table class="table table-striped">
      <thead>
        <tr>
          <th>Esta Cartera</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Recaudado</td>
          <td class="text-right">$ 43.000.00</td>
        </tr>

        <tr>
          <td>Prestamos</td>
          <td class="text-right">$ 0.00</td>
        </tr>

        <tr>
          <td>Capital</td>
          <td class="text-right">$ 34.400.00</td>
        </tr>

        <tr>
          <td>Intereses</td>
          <td class="text-right">$ 8.600.00</td>
        </tr>

        <tr>
          <td>Gastos</td>
          <td class="text-right">$ 0.00</td>
        </tr>

        <tr>
          <td>Base</td>
          <td class="text-right">$ 0.00</td>
        </tr>

        <tr>
          <td>Efectivo</td>
          <td class="text-right">$ 0.00</td>
        </tr>

      </tbody>
      <tfooter>
        <tr>
          <td>Verificar</td>
          <td class="text-right">$ 43.000.00</td>
        </tr>
        <tr>
          <td>Diferencia</td>
          <td class="text-right">$ -43.000.00</td>
        </tr>
      </tfooter>
</table>
    </div>

    <section>
        <div class="col-md-6">
            
<table class="table table-striped">
    <caption>Prestamos Nuevos</caption>
      <thead>
        <tr>
          <th>Cédula</th>
          <th>Nombre</th>
          <th>Prestado</th>
          <th>Ult. Abono</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        
      </tbody>
</table>
        </div>

        <div class="col-md-6">
            
<table class="table table-striped">
    <caption>Prestamos Ingresados</caption>
      <thead>
        <tr>
          <th>Cédula</th>
          <th>Nombre</th>
          <th>Prestado</th>
          <th>Ult. Abono</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        
      </tbody>
</table>
        </div>

        <div class="col-md-6">
            
<table class="table table-striped">
    <caption>Tarjetas Canceladas</caption>
      <thead>
        <tr>
          <th>Cédula</th>
          <th>Nombre</th>
          <th>Prestado</th>
          <th>Ult. Abono</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        
      </tbody>
</table>
        </div>

        <div class="col-md-6">
            
<table class="table table-striped">
    <caption>Tarjetas Retiradas</caption>
      <thead>
        <tr>
          <th>Cédula</th>
          <th>Nombre</th>
          <th>Prestado</th>
          <th>Ult. Abono</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        
      </tbody>
</table>
        </div>
    </section>

    <div class="modal fade" id="modal-comment">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          </div>

          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="message-text" class="control-label">Comentario:</label>
                <textarea class="form-control" id="message-text"></textarea>
              </div>
            </form>
        </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
            <button type="button" id="btnComentario" class="btn btn-primary">Guardar Comentario</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->


    <div class="modal fade" id="modal-retirar">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          </div>

          <div class="modal-body">
            <p>La tarjeta se marcara como retirada</p>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
            <a href="/deuda/retirar/244472/" type="button" class="btn btn-danger">Retirar Tarjeta?</a>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
</content>



        <hr />

        <footer class="footer">
            <div class="col-xs-7">
                <p>Copyright © 2014</p>
            </div>
            <div class="col-xs-5">
                <p>Desarrollado por <a href="http://www.solucionesvulcano.com/">Soluciones Vulcano</a>
                </p>
            </div>
        </footer>
    </div>
    <!-- /container -->
    <script type="text/javascript" src="/static/CACHE/js/fb2155ce8ec0.js"></script>
    
<script type="text/javascript" src="/static/CACHE/js/c56766390804.js"></script>

<script type='text/javascript'>
$(document).ready(function() {
    data = {'deuda_id': 244472, 'codigo': '43894466-1', 'nombre': 'JUANA MIELES SALGADO', 'direccion': 'CLL 41 CR 9 N 1-05 24 NOV', 'telefono': '3235916586', 'plazo': 60, 'valor': Decimal('200'), 'valorPagar': Decimal('240000.00'), 'cuota': Decimal('4000.00'), 'fecha': datetime.datetime(2022, 7, 21, 0, 0), 'dias': -17, 'vencidos': 373, 'calificacion': 'Clavo', 'saldo': None, 'loteria': '4466', 'valorLoteria': Decimal('4000.00'), 'inicializarCobro': False};
    var errors = {};
    var comentarios = ko.observableArray([]);

    console.log("DATA", data);
    console.log("E", errors);

    var isValid = function() {
        return Object.keys(errors).length == 0;
    }

    var getError = function(name) {
        return errors[name];
    }

    var errorList = []
    $.each(errors, function(key, value) {
        console.log(key, value);
        errorList.push(key + ": " + value);
    });

    var formDeuda = {
        deuda_id: ko.observable(data.deuda_id),
        codigo: ko.observable(data.codigo),
        nombre: ko.observable(data.nombre),
        direccion: ko.observable(data.direccion),
        telefono: ko.observable(data.telefono),
        fecha: ko.observable(data.fecha),
        valor: ko.observable(data.valor),
        valorPagar: ko.observable(data.valorPagar),
        cuota: ko.observable(data.cuota),
        plazo: ko.observable(data.plazo),
        dias: ko.observable(0),
        saldo: ko.observable(0),
        loteria: ko.observable(data.loteria),
        valorLoteria: ko.observable(data.valorLoteria),
        inicializarCobro: ko.observable(data.inicializarCobro),
        isValid: isValid,
        errors: errorList,
        canSave:ko.observable(true),
    };

    var formDeudaVieja = {
        deuda_id: ko.observable(data.deuda_id),
        calificacion:ko.observable(""),
        zona:ko.observable(""),
        class_calificacion:ko.observable(""),
        valor: ko.observable(0),
        valorPagar: ko.observable(0),
        atrasados: ko.observable(0),
        adelantados: ko.observable(0),
        vencidos: ko.observable(0),
        saldo: ko.observable(0),
        orden: ko.observable(0),
    };

    function jumpPage(page) {
        
        window.location.href = '/deudas/' + 'AYAPEL' + '/?page=' + (page);
        console.log("BYE");
        
    }

    function nextPage() {
        
        var page = 1;
        jumpPage(page + 1);
        
    }

    function nextPageCancelo() {
        
        var page = 1;
        jumpPage(page);
        
    }


    function formAbono() {
        valorAbono = ko.observable();

        self.canSave= ko.pureComputed( function() {
            //console.log("Puede?", self._falta() >= Decimal(0));
            return self._falta() >= Decimal(0);
        });

        self._falta = ko.pureComputed(function() {
            var falta = cleanEditNumber("30000,00");

            var valor = self.valorAbono();
            if (valor) {
                var abono =  cleanMaskedNumber(valor);
                console.log( toMoney(valor), toMoney(abono));

                return falta.sub(abono);

            }
            return falta;
        });
        self.falta = ko.pureComputed(function() {
            return toMoney(self._falta());
        });

        self.saldo = ko.pureComputed(function() {
              return toMoney(cleanEditNumber("210000,00"));
         });

        self.comentarios = comentarios;

        self.eliminarCuota = function() {
            POST(
                "/ajax/del_abono/",
                {
                    deuda_id: formDeuda.deuda_id(),
                },
                function(data) {
                    location.reload(true);
                }
            );
        },
        self.doAbonar = function(formElement) {
            if (self.valorAbono()) {
                POST(
                    "/ajax/add_abono/",
                    {
                        deuda_id: formDeuda.deuda_id(),
                        cobrador_id: 1,
                        valor: self.valorAbono()
                    },
                    function(data) {
                        console.log(data);
                        
                            if (data.esCancelada) {
                                nextPageCancelo();
                            } else {
                                nextPage();
                            }
                        
                    }
                );
            } else {
                nextPage();
            }
        };
    };

    var formVencidos = {
        vencidos: ko.observable(data.vencidos),
        dias: ko.observable(data.dias),
        calificacion: ko.observable("Clavo"),
    };

    ko.applyBindings(formDeuda, $('#formDeuda')[0]);

    $("#id_valor").mask(maskDecimal);
    $("#id_valorAbono").mask(maskDecimal);
    $("#id_fecha").mask(maskDate);
    $("#id_plazo").mask('99');
    // $("#id_codigo").mask("999-99-9999");
   var remote = new Bloodhound({
      identify: function(obj) { return obj.codigo; },
      datumTokenizer: Bloodhound.tokenizers.whitespace,
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      remote: {
        url: '/search/deuda/?deuda_id=' + data.deuda_id + '&q=%QUERY',
        wildcard: '%QUERY'
      }
    });
    var editCodigo = $('#id_codigo');

    var listClientes = {};

    editCodigo.typeahead({
        minLength: 3,
        highlight: true},{
        display: 'codigo',
        limit: 550,
        hint: true,
        name: 'clientes',
        source: remote,
        templates: {
             empty: [
              '<div class="alert alert-warning" role="alert">No se encontraron datos</div>'
            ].join('\n'),
            suggestion: function(data) {
                listClientes[data.codigo] = data;

                extra= '';
                console.log(data.estado);
                if (data.estado=='ACTIVA') {
                    extra= '<p class="text-primary">';
                };

                var markup = '<div class="row combobox">' +
                   '<div class="col-xs-4">' + extra + data.codigo + '</div>' +
                   '<div class="col-xs-8">' + extra + data.nombre + '</div>' +
                   '</div>';

                return markup;
            }
        }
    });


    ko.applyBindings(formAbono, $('#formAbono')[0]);
    ko.applyBindings(formVencidos, $('#formVencidos')[0]);
    ko.applyBindings(formVencidos, $('#formTarjetaBar')[0]);
    $("#id_valorAbono").focus();


    function selectCliente(data) {
        var isOk = true;
        console.log("DT", data);
        if (data) {
            console.log("Select:", data.codigo, " ",  formDeuda.codigo());
            console.log("BYE", data.deuda_id);

            
                console.log("Pick");
                window.location.href = '/deudas/' + data.cobro_id + '/' + data.deuda_id;
                console.log("BYE");
            
        }

        console.log(isOk);
        formDeuda.canSave(isOk);
    }

    editCodigo.bind('typeahead:open', function(ev) {
      console.log('Open: ');
      listClientes = {};
      formDeuda.canSave(false);
    });

    editCodigo.bind('typeahead:close', function(ev) {
        console.log('Close: ');
        
    });

    editCodigo.bind('typeahead:select', function(ev, suggestion) {
      console.log('Selection:', suggestion);
      selectCliente(suggestion);
    });

    editCodigo.bind('typeahead:autocomplete', function(ev, suggestion) {
      console.log('Auto: ', suggestion);
      selectCliente(suggestion);
    });

    editCodigo.bind('typeahead:change', function(ev) {
      console.log('Get: ', ev.target.value);
      console.log(listClientes[ev.target.value]);
      var suggestion = listClientes[ev.target.value];
      selectCliente(suggestion);
    });


    $('#modal-comment').on('show.bs.modal', function (event) {
      var button = $(event.relatedTarget);
      var modal = $(this)
      modal.find('#message-text').val("");
    });

    $('#btnComentario').on('click', function () {
        var $btn = $(this).button('loading')

        var comment = $.trim($("#message-text").val());
        console.log(comment);

        
        if (comment.length) {
            POST(
                "/ajax/add_comentario/",
                {
                    deuda_id: 244472,
                    comment: comment,
                },
                function(data) {
                    console.log(data);
                    comentarios.push(data);
                    $('#modal-comment').modal('hide')
                }
            );
        };
        

        $btn.button('reset')
    });


    function setOrder(order) {
        $("#menu_posicion").text("+ Cliente " + order);
        POST(
            "/ajax/posicion/" + order + "/", {},
            function(data) {
                console.log("O ", data);
            }
        );
    };

    $("#id_antes").on("click", function(){
        setOrder("antes");
    });
    $("#id_despues").on("click", function(){
        setOrder("despues");
    });
});
</script>

</body>

</html>
